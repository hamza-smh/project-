define(["require","exports","tslib","external/lodash","rondo/v1/behavior","modules/clean/teams/admin/pages/activity/filters/members_picker_behavior","modules/clean/rondo/forms/behaviors/form_auto_submit_behavior","modules/clean/rondo/forms/behaviors/form_behavior","modules/clean/teams/admin/pages/activity/activity_api","modules/clean/rondo/forms/behaviors/form_submit_behavior","rondo/v1/index","modules/clean/teams/admin/pages/activity/filters/initial_values","modules/clean/teams/admin/pages/activity/filters/submit","modules/clean/rondo/components/members_picker/contacts_picker_behavior","modules/clean/teams/admin/pages/activity/filters/filters_url","rondo/v1/selectors","modules/clean/teams/admin/pages/activity/filters/filter_logger","modules/clean/teams/admin/pages/activity/behaviors/activity_page","modules/clean/rondo/components/members_picker/contacts_picker_behavior","modules/clean/teams/admin/pages/activity/behaviors/activity_logger"],(function(e,t,i,a,r,l,s,n,o,c,m,u,d,v,h,p,f,y,F,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=i.__importStar(a),t.FiltersBehaviorFactory=function(e,t){return(function(){function l(){var l=this;this.initialState=function(){return{allowSetFilter:!1}},this.actionAllowSetFilters=m.createAction().handle((function(){return{allowSetFilter:!0}})),this.actionClearFilters=m.createAction().watch((function(){l.actionSetValues({fieldsToValue:u.filtersValuesClear()})})),this.canSubmitFilters=p.createSelector((function(e){return e.allowSetFilter})),this.actionSubmit=m.createOrUseIn(this,y.activityPage.actionSubmit).watch((function(){var e=l.validValues(),t=h.filtersToURLSearch(e),i=y.activityPage.search();a.isEqual(t,i)||y.activityPage.actionLocationPush({search:t,merge:!1})})),this.actionSetMemberFilter=m.createOrUseIn(this,y.activityPage.filters.actionSetMemberFilter).watch((function(e,t){var a=t.account_id,r=t.email;return i.__awaiter(l,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:return[4,o.partakerByAccountIdAndEmail(r,a)];case 1:return(e=t.sent())&&this.actionSetValues({fieldsToValue:i.__assign(i.__assign({},u.filtersValuesClearNoDate()),{members:e.map((function(e){return v.parseTokenObject(e)}))})}),[2]}}))}))})),this.acionSetActivityFilter=m.createOrUseIn(this,y.activityPage.filters.actionSetActivityFilter).watch((function(e,t){var a=t;a&&l.actionSetValues({fieldsToValue:i.__assign(i.__assign({},u.filtersValuesClearNoDateAndTeams()),{activity:[a]})})})),r.extendBehavior(this,s.FormAutoSubmitBehavior({commitAction:y.activityPage.actionResults,dirtyAction:y.activityPage.actionDirty,submitFunction:t,submitAction:[y.activityPage.actionSubmit,y.activityPage.actionFetch],fields:e,additionalStateFieldsGenerator:c.additionalStateFieldsAPIv2,submitPartialValid:!0,canSubmit:this.canSubmitFilters}))}return l.displayName="Filters",l})()};var _=(function(){function e(){this.initialState=function(){return{}},this.date=n.FieldBehaviorFactory({initialValue:u.dateFilterValueClear(),clearValue:u.dateFilterValueClear()}),this.members=m.createBehavior(F.TypeAheadFactory(l.ActivityDataSource)),this.participants=n.FieldBehaviorFactory({initialValue:u.emptyEnumValueClear(),clearValue:u.emptyEnumValueClear()}),this.file=n.FieldBehaviorFactory({initialValue:u.fileFilterValueClear(),clearValue:u.fileFilterValueClear()}),this.teams=n.FieldArrayBehaviorFactory({initialValue:u.emptyListFilterValueClear(),clearValue:u.emptyListFilterValueClear()}),this.activity=n.FieldArrayBehaviorFactory({initialValue:u.emptyListFilterValueClear(),clearValue:u.emptyListFilterValueClear()}),r.extendBehavior(this,t.FiltersBehaviorFactory({file:this.file,teams:this.teams,activity:this.activity,members:this.members,participants:this.participants,date:this.date},d.submit)),r.extendBehavior(this,f.LoggerCreator(b.logActivityPageEventToHive,[{action:this.date.actionFieldChange,parser:f.dateEvent},{action:this.members.actionFieldAdd,parser:f.memberEvent},{action:this.members.actionFieldReplace,parser:f.memberReplaceEvent},{action:this.members.actionFieldRemove,parser:f.memberRemoveEvent},{action:this.actionClearFilters,parser:function(){return{eventName:"clear_filters",extra:{}}}},{action:this.date.actionClear,parser:f.collapsedFilterEvent("date")},{action:this.members.actionClear,parser:f.collapsedFilterEvent("member")},{action:this.file.actionClear,parser:f.collapsedFilterEvent("file")},{action:this.activity.actionClear,parser:f.collapsedFilterEvent("activity")},{action:this.file.actionFieldChange,parser:f.fileEvent}]))}return e.displayName="FiltersBehaviorInherit",e})();t.FiltersBehavior=_}));
//# sourceMappingURL=filters_behavior.min.js-vflthmUJ9.map