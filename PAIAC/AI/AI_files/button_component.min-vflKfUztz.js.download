define(["require","exports","tslib","classnames","prop-types","react","spectrum/button","spectrum/popover","modules/clean/filepath","modules/clean/react_format","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/util","modules/clean/react/share_download/models","modules/clean/react/share_download/util","modules/clean/share_download/types","modules/clean/react/title_bubble","modules/core/i18n","modules/core/browser_detection","modules/clean/react/file_viewer_sidebar/buttons/icon"],(function(t,e,o,i,n,s,l,r,a,p,d,c,u,h,m,f,_,b,D,w,g){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=o.__importDefault(i),n=o.__importDefault(n),s=o.__importDefault(s),a=o.__importStar(a);var C=function(t){return w.is_mobile_or_tablet()||!t.title?s.default.createElement(s.default.Fragment,null,t.children):s.default.createElement(b.TitleBubble,{content:t.title,isTargetPositionFixed:!0,position:b.TitleBubble.POSITIONS.BOTTOM_ALIGN_LEFT},t.children)},y=(function(t){function e(e){var o=t.call(this,e)||this;return o.state={isDisabled:!0},o}return o.__extends(e,t),e.prototype.componentDidMount=function(){this.setState({isDisabled:this.props.isDisabled})},e.prototype.render=function(){var t={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return this.props.className&&(t[this.props.className]=!0),s.default.createElement(C,{title:this.props.title},s.default.createElement(l.Button,{className:i.default(t),style:{display:"-webkit-box"},variant:this.props.importance,disabled:this.state.isDisabled,onClick:this.props.onClick,"aria-label":this.props.title},this.props.children))},e.defaultProps={isDisabled:!1,importance:"secondary"},e})(s.default.Component),v=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.render=function(){var t=this;return s.default.createElement(y,{isDisabled:this.props.isDisabled,onClick:function(e){e.preventDefault(),t.props.onClick&&t.props.onClick(t.props.option),t.props.option.handler(),d.logUserAction(t.props.option.userAction,u.getSplitButtonUserActionContext(c.SplitButtonActionLocation.Main,t.props.location))},importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:this.props.title},this.props.isCollapsed?s.default.createElement(g.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance}):this.props.targetText)},e})(s.default.Component);e.DownloadSimpleButton=v;var T=(function(t){function e(e){var o=t.call(this,e)||this;return o.onPopoverSelection=function(t){h.callOptionHandler(t,c.SplitButtonActionLocation.Split,o.props.onClick,o.props.location)()},o.state={isDisabled:!0},o}return o.__extends(e,t),e.prototype.componentDidMount=function(){this.setState({isDisabled:this.props.isDisabled})},e.prototype.renderIcon=function(){return s.default.createElement(g.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance,"aria-label":this.props.title})},e.prototype.renderPopover=function(){var t=this.props.options.map((function(t){return s.default.createElement(r.PopoverContentItem,{key:t.text,value:t,disabled:t.isDisabled},t.text)})),e={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return s.default.createElement(r.Popover,{key:"download-dropdown",onSelection:this.onPopoverSelection},s.default.createElement(r.PopoverTrigger,{"aria-label":this.props.title},s.default.createElement(C,{title:this.props.title},s.default.createElement(l.Button,{className:i.default(e),tagName:"span",variant:this.props.importance,disabled:this.state.isDisabled,"aria-label":this.props.title},this.props.isCollapsed?this.renderIcon():this.props.targetText))),s.default.createElement(r.PopoverContent,{attachment:"right"},t))},e.prototype.render=function(){return this.props.isDisabled?s.default.createElement(y,{isDisabled:!0,importance:this.props.importance,title:this.props.title,isCollapsed:this.props.isCollapsed},this.props.isCollapsed?this.renderIcon():this.props.targetText):this.renderPopover()},e.defaultProps={importance:"secondary"},e})(s.default.Component);e.DownloadDropdown=T;var x=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.isDownloadAllowed=function(){return this.props.sharePermission.canDownloadRoles.length>0},e.prototype.getTargetText=function(t){if(this.isDownloadAllowed())return t>1?{title:D._("Download â–¾")}:{title:D._("Download")};if(this.props.user&&this.props.user.is_cdm_member){var e=a.filename(this.props.user.cdm_tmf_path);return e.length>25?{title:D._("Add to my member folder")}:{label:p.reactFormat(D._("Add to <strong>%(cdm_tmf_name)s</strong> folder"),{cdm_tmf_name:e,strong:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.default.createElement("strong",{style:{fontWeight:800}},t)}}),title:D._("Add to %(cdm_tmf_name)s folder").format({cdm_tmf_name:e})}}return{title:D._("Add to Dropbox")}},e.prototype.getTooltipLabel=function(){return _.isPendingEntry(this.props.copyable)?D._("Download is unavailable while file is uploading."):D._("Downloads disabled.")},e.prototype.render=function(){var t=f.getDownloadOptions(this.props.sharePermission,this.props.sharedLinkInfo,this.props.shareToken,this.props.copyable,this.context.authModalKind||null,this.props.user);if(this.props.downloadOnly){var e=new m.ShareDownloadActionOption({isDisabled:!0}),o=!0;return this.isDownloadAllowed()&&(e=m.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo),o=!1),s.default.createElement(v,{isDisabled:o,targetText:D._("Download"),title:D._("Download"),option:e,onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed})}if(0===t.length)return s.default.createElement(T,{targetText:D._("Download"),isDisabled:!0,options:[new m.ShareDownloadActionOption({isDisabled:!0})],onClick:this.props.onClick,location:this.props.location,title:this.getTooltipLabel(),importance:this.props.importance,isCollapsed:this.props.isCollapsed});var i=this.getTargetText(t.length);return 1===t.length?s.default.createElement(v,{isDisabled:!1,targetText:i.label||i.title,title:i.title,option:t[0],onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed}):s.default.createElement(T,{targetText:i.label||i.title,options:t,onClick:this.props.onClick,location:this.props.location,isDisabled:!1,importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:D._("Download")})},e.contextTypes={authModalKind:n.default.oneOf(["immediate","download",null])},e})(s.default.Component);e.ShareDownloadButton=x}));
//# sourceMappingURL=button_component.min.js-vflN8VNmN.map